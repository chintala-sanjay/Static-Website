<script>

    // Village data handling
    async function fetchVillageData() {
        try {
            const response = await fetch('./data/village_data.json');
            const data = await response.json();
            return data;
        } catch (error) {
            console.error('Error fetching village data:', error);
            return [];
        }
    }

    async function populateVillages(mandalName) {
        const villageData = await fetchVillageData();
        const villageCardsContainer = document.getElementById('villageCards');
        villageCardsContainer.innerHTML = ''; // Clear existing cards

        // Find the mandal in the data
        let mandalVillages = null;
        for (const mandal of villageData) {
            if (mandal[mandalName]) {
                mandalVillages = mandal[mandalName];
                break;
            }
        }

        if (mandalVillages) {
            mandalVillages.forEach(village => {
                const villageCard = document.createElement('div');
                villageCard.className = 'village card';
                villageCard.innerHTML = `
                        <h3>${village["Village Name"]}</h3>
                        <p>Population: ${village["Population"] || village["Total Population"]}</p>
                        <p>Male Population: ${village["Male Population"]}</p>
                        <p>Female Population: ${village["Female Population"]}</p>
                        <p>Area: ${village["Area (sq. km)"] || village["Village Area (sq. km)"]}</p>
                        <p>Literacy Rate: ${village["Literacy Rate (%)"]}</p>
                    `;
                villageCardsContainer.appendChild(villageCard);
            });
        } else {
            villageCardsContainer.innerHTML = '<p>No data found for this mandal.</p>';
        }
    }

</script>